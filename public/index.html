<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
    <title>Hungry Frog</title>
</head>
<body>

    <!-- Game Front Page -->
    <div id="signin-overlay" class="overlay">
        <div class="content shadow">
            <div class="form-container">
                <div>
                    <form id="signin-form">
                        <div class="caption">SIGN IN WITH YOUR ACCOUNT</div>
                        <div class="spacer-0"></div>
                        <input id="signin-username" placeholder="Enter your username"></input>
                        <input id="signin-password" type="password" placeholder="Enter your password"></input>
                        <div class="spacer-0"></div>
                        <button type="submit">Sign In</button>
                        <div id="signin-message" class="warning center"></div>
                        <div class="spacer-grow"></div>
                    </form>

                    <div id="sign-out-container">
                        <div id="sign-out-caption">Signed in as:</div>
                        <div id="signed-in-username">???</div>
                        <button id="signout-btn">Sign Out</button>
                    </div>
                </div>

                <div id="game-title">
                    <span>Hungry</span>
                    <span>Frog</span>
                </div>
    
                <form id="register-form">
                    <div class="caption">REGISTER IF YOU DO NOT HAVE ONE</div>
                    <div class="spacer-0"></div>
                    <input id="register-username" maxlength="10" placeholder="Enter your username"></input>
                    <input id="register-name" maxlength="16" placeholder="Enter your name"></input>
                    <input id="register-password" type="password" placeholder="Enter your password"></input>
                    <input id="register-confirm" type="password" placeholder="Enter your password again"></input>
                    <div class="spacer-0"></div>
                    <button type="submit">Register</button>
                    <div id="register-message" class="warning center"></div>
                </form>
            </div>

            <div id="game-description-instruction">
                    Collect as much points as possible within 60s, or first reach 250 points to win. 
                    Smaller balls move faster, but more points, vice versa.
                    Tongue cooldown: 2s.
                    Collect blue balls to get freeze ability. Press "F" to deploy and freeze the opponent for 6s.
                    Your can CHEAT by presss "D", then you have double points for 6s. Unlimited times of CHEATING.
            </div>

            <div id="player-selection-container">
                <div id="player1-container">
                    <span class="player-title">Player 1:</span>
                    <span id="player1-name">???</span>
                    <button id="join-player1-btn" class="player-join-btn">Join</button>
                </div>
                <div id="player2-container">
                    <span class="player-title">Player 2:</span>
                    <span id="player2-name">???</span>
                    <button id="join-player2-btn" class="player-join-btn">Join</button>
                </div>
            </div>
            
            <div id="online-user-panel">
                <span>Online users: </span>
                <span id="online-user-list"></span>
            </div>

        </div>
    </div>

    <!-- Game Play Page -->
    <div id="game-play-page" >
        <section id="game-play-layout">
            <div id="game-play-header">
                <!-- <button id="start-game-button">Temp button to start game</button> -->
                <!-- <button id="reset-button">Reset game (Reset AFTER the game has ended)</button> -->
                <div>
                    Collect as much points as possible within 60s, or first reach 250 points to win. 
                    Smaller balls move faster, but more points, vice versa.
                    Tongue cooldown: 1s.
                    Collect blue balls to get freeze ability. Press "F" to deploy and freeze the opponent for 6s.
                    Your can CHEAT by presss "D", then you have double points for 6s. Unlimited times of CHEATING.   
                </div>
            </div>

            <div id="game-arena">
                <div id="game-arena-text-box">Hungry Frog</div>
            </div>

            <div id="player-ability-panels">
                <div id="p1-ability-panel" class="ability-panel"></div>
                <div id="p2-ability-panel" class="ability-panel"></div>
            </div>

            <div id="game-status-panel">
                <div id="p1-points-panel" class="points-panel"></div>
                <svg id="timer" viewBox="0 0 200 200"></svg>
                <div id="p2-points-panel" class="points-panel"></div>
            </div>
        </section>
    </div> 
    <!-- Game End Page-->
    <div class="page3" style = "display: none;">
        <div class="content">
          <div class="left">
            <h2>Leaderboard</h2>
            <table class="info-table">
              <thead>
                <tr>
                  <th>Player</th>
                  <th>Time</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td id="player1">Player 1</td>
                  <td id="time1">1:23</td>
                </tr>
                <tr>
                  <td id="player2">Player 2</td>
                  <td id="time2">1:45</td>
                </tr>
                <tr>
                  <td id="player3">Player 3</td>
                  <td id="time3">2:10</td>
                </tr>
                <tr>
                  <td id="player4">Player 4</td>
                  <td id="time4">2:35</td>
                </tr>
                <tr>
                  <td id="player5">Player 5</td>
                  <td id="time5">3:05</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="right">
            <table class="info-table">
                <tr>
                  <td>Info</td>
                  <td id="info1"></td>
                </tr>
                <tr>
                  <td>info</td>
                  <td id="info2"></td>
                </tr>
                <tr>
                  <td>info</td>
                  <td id="info3"></td>
                </tr>
              </table>
            <div class="buttons">
              <button class="restart-button">Restart</button>
              <button class="title-button">Return to Title Page</button>
            </div>
          </div>
        </div>
      </div>


    <!-- Scripts -->
    <script src="/socket.io/socket.io.min.js"></script>
    <script src="components/Socket.js"></script>
    <script src="components/GameArena.js"></script>
    <script src="components/GameController.js"></script>
    <script src="components/UserFrog.js"></script>
    <script src="components/UserFrogTongue.js"></script>
    <script src="components/Pond.js"></script>
    <script src="components/Marbles.js"></script>
    <script src="components/PointsPanel.js"></script>
    <script src="components/AbilityPanel.js"></script>
    <script src="components/TimePanel.js"></script>

    <script src="components/AudiencePack.js"></script>

    <script src="components/UI.js"></script>
    <script src="components/Registration.js"></script>
    <script src="components/Authentication.js"></script>

    <script src="utils.js"></script>
    <script>
        $(function() {
            // Initialize the UI
            UI.initialize();

            // Validate the signin
            Authentication.validate(
                () => {
                    SignInForm.hide();
                    UserPanel.update(Authentication.getUser());
                    UserPanel.show();

                    Socket.connect();
                },
                () => { SignInForm.show(); }
            );

            // console.log("Init")
            // Socket.connect()

            // Build fixed size canvas and context
            const CANVAS_WIDTH = 800
            const CANVAS_HEIGHT = 600
            let arena = $("#game-arena")
            arena.append(`<canvas id="game-arena-canvas" width="${CANVAS_WIDTH}" height="${CANVAS_HEIGHT}"></canvas>`)
            let canvas = $("#game-arena-canvas")
            let context = canvas.get(0).getContext("2d")

            // // A tmp function that starts the game by click button
            // $("#start-game-button").on("click", (e) => {
            //     Socket.startGame() // Also calls GameController.startGame()
            // })

            $("#reset-button").on("click", (e) => {
                Socket.resetGameSettings() // Also calls GameController.resetGameSettings()
            })


        });
    </script>
</body>
</html>